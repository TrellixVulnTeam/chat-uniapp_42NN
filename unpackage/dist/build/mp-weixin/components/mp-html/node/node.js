(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/mp-html/node/node"],{"0718":function(t,s,i){"use strict";var e=i("541e"),o=i.n(e);o.a},3230:function(t,s,i){"use strict";(function(t){function e(t){var s;return s=t.detail.y,s-t.currentTarget.offsetTop<150&&(s=t.currentTarget.offsetTop),s<30&&(s+=70),s-30}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o=function(){Promise.resolve().then(function(){return resolve(i("94c3"))}.bind(null,i)).catch(i.oe)},r={name:"node",options:{virtualHost:!0},data:function(){return{ctrl:{}}},props:{name:String,attrs:{type:Object,default:function(){return{}}},childs:Array,opts:Array},components:{node:o},mounted:function(){var t=this;this.$nextTick((function(){for(t.root=t.$parent;"mp-html"!==t.root.$options.name;t.root=t.root.$parent);}))},beforeDestroy:function(){this.root._edit===this&&(this.root._edit=void 0)},methods:{editStart:function(t){var s=this;if(this.opts[4]){var i=t.currentTarget.dataset.i;this.ctrl["e"+i]?(this.root._mask.pop(),this.root._maskTap(),this.$set(this.ctrl,"e"+i,2),setTimeout((function(){s.$set(s.ctrl,"e"+i,3)}),50)):(this.$set(this.ctrl,"e"+i,1),setTimeout((function(){s.root._mask.push((function(){return s.$set(s.ctrl,"e"+i,0)}))}),50),this.root._edit=this,this.i=i,this.cursor=this.childs[i].text.length)}},editInput:function(t){var s=t.target.dataset.i,i=t.detail.value.replace(/ {2,}/,(function(t){for(var s=" ",i=1;i<t.length;i++)s+=" ";return s}));this.root._editVal("".concat(this.opts[6],".").concat(s,".text"),this.childs[s].text,i),this.cursor=t.detail.cursor},editEnd:function(t){var s=t.target.dataset.i;this.$set(this.ctrl,"e"+s,0),this.root._setData("".concat(this.opts[6],".").concat(s,".text"),t.detail.value),void 0!==t.detail.cursor&&(this.cursor=t.detail.cursor)},insert:function(t){var s=this;setTimeout((function(){var i=s.childs.slice(0);if(i[s.i])if(i[s.i].text){var e=i[s.i].text,o=[];s.cursor&&o.push({type:"text",text:e.substring(0,s.cursor)}),o.push(t),s.cursor<e.length&&o.push({type:"text",text:e.substring(s.cursor)}),i.splice.apply(i,[s.i,1].concat(o))}else i.splice(parseInt(s.i)+1,0,t);else i.push(t);s.root._editVal(s.opts[6],s.childs,i,!0),s.i=parseInt(s.i)+1}),200)},remove:function(t){var s=this.childs.slice(0),i=s.splice(t,1)[0];if("img"===i.name||"video"===i.name||"audio"===i.name){var e=i.attrs.src;i.src&&(e=1===i.src.length?i.src[0]:i.src),this.root.$emit("remove",{type:i.name,src:e})}this.root._edit=void 0,this.root._maskTap(),this.root._editVal(this.opts[6],this.childs,s,!0)},nodeTap:function(t){var s=this;if(this.opts[4]){if(this.root._lock)return;if(this.root._lock=!0,setTimeout((function(){s.root._lock=!1}),50),3===this.ctrl["e"+this.i])return;this.root._maskTap(),this.root._edit=this;var i=this.opts[6].lastIndexOf("children.");-1!==i?i+=9:i=6;var o=parseInt(this.opts[6].substring(i,this.opts[6].lastIndexOf(".children"))),r=this.$parent;while(r&&"node"!==r.$options.name)r=r.$parent;if(!r||this.opts[6].length-r.opts[6].length>15)return;this.$set(this.ctrl,"root",1),this.root._mask.push((function(){return s.$set(s.ctrl,"root",0)})),1!==this.childs.length||"text"!==this.childs[0].type||this.ctrl.e0||(this.$set(this.ctrl,"e0",1),this.root._mask.push((function(){return s.$set(s.ctrl,"e0",0)})),this.i=0,this.cursor=this.childs[0].text.length);var a=this.root._getItem(r.childs[o],0!==o,o!==r.childs.length-1);this.root._tooltip({top:e(t),items:a,success:function(i){if("大小"===a[i]){var n=r.childs[o].attrs.style||"",c=n.match(/;font-size:([0-9]+)px/);c=c?parseInt(c[1]):16,s.root._slider({min:10,max:30,value:c,top:e(t),changing:function(s){Math.abs(s-c)>2&&(r.changeStyle("font-size",o,s+"px",c+"px"),c=t.detail.value)},change:function(t){t!==c&&r.changeStyle("font-size",o,t+"px",c+"px"),s.root._editVal("".concat(r.opts[6],".").concat(o,".attrs.style"),n,r.childs[o].attrs.style)}})}else if("上移"===a[i]||"下移"===a[i]){var h=r.childs.slice(0),l=h[o];"上移"===a[i]?(h[o]=h[o-1],h[o-1]=l):(h[o]=h[o+1],h[o+1]=l),s.root._editVal(r.opts[6],r.childs,h,!0)}else if("删除"===a[i])r.remove(o);else{var u,d,f=r.childs[o].attrs.style||"",p="",g=a[i];"斜体"===g?(u="font-style",d="italic"):"粗体"===g?(u="font-weight",d="bold"):"下划线"===g?(u="text-decoration",d="underline"):"居中"===g?(u="text-align",d="center"):"缩进"===g&&(u="text-indent",d="2em"),p=f.includes(u+":")?f.replace(new RegExp(u+":[^;]+"),""):f+";"+u+":"+d,s.root._editVal("".concat(r.opts[6],".").concat(o,".attrs.style"),f,p,!0)}}})}},mediaTap:function(s){var i=this;if(this.opts[4]){var e=s.target.dataset.i,o=this.childs[e],r=this.root._getItem(o);this.root._edit=this,this.i=e,this.root._tooltip({top:s.target.offsetTop-30,items:r,success:function(s){switch(r[s]){case"封面":i.root.getSrc("img",o.attrs.poster||"").then((function(t){i.root._editVal("".concat(i.opts[6],".").concat(e,".attrs.poster"),o.attrs.poster,t instanceof Array?t[0]:t,!0)})).catch((function(){}));break;case"删除":i.remove(e);break;case"循环":case"不循环":i.root._setData("".concat(i.opts[6],".").concat(e,".attrs.loop"),!o.attrs.loop),t.showToast({title:"成功"});break;case"自动播放":case"不自动播放":i.root._setData("".concat(i.opts[6],".").concat(e,".attrs.autoplay"),!o.attrs.autoplay),t.showToast({title:"成功"});break}}}),this.root._lock=!0,setTimeout((function(){i.root._lock=!1}),50)}},changeStyle:function(t,s,i,e){var o=this.childs[s].attrs.style||"";o.includes(";"+t+":"+e)?o=o.replace(";"+t+":"+e,";"+t+":"+i):o+=";"+t+":"+i,this.root._setData("".concat(this.opts[6],".").concat(s,".attrs.style"),o)},toJSON:function(){},play:function(s){if(this.root.$emit("play"),this.root.pauseVideo){for(var i=!1,e=s.target.id,o=this.root._videos.length;o--;)this.root._videos[o].id===e?i=!0:this.root._videos[o].pause();if(!i){var r=t.createVideoContext(e,this);r.id=e,this.root._videos.push(r)}}},imgTap:function(s){var i=this;if(this.opts[4]){var o=s.currentTarget.dataset.i,r=this.childs[o],a=this.root._getItem(r);this.root._edit=this,this.i=o,this.root._maskTap(),this.$set(this.ctrl,"e"+o,1),this.root._mask.push((function(){return i.$set(i.ctrl,"e"+o,0)})),this.root._tooltip({top:e(s),items:a,success:function(n){if("换图"===a[n])i.root.getSrc("img",r.attrs.src||"").then((function(t){i.root._editVal(i.opts[6]+"."+o+".attrs.src",r.attrs.src,t instanceof Array?t[0]:t,!0)})).catch((function(){}));else if("宽度"===a[n]){var c=r.attrs.style||"",h=c.match(/max-width:([0-9]+)%/);h=h?parseInt(h[1]):100,i.root._slider({min:0,max:100,value:h,top:e(s),changing:function(t){Math.abs(t-h)>5&&(i.changeStyle("max-width",o,t+"%",h+"%"),h=t)},change:function(t){t!==h&&(i.changeStyle("max-width",o,t+"%",h+"%"),h=t),i.root._editVal(i.opts[6]+"."+o+".attrs.style",c,i.childs[o].attrs.style)}})}else"超链接"===a[n]?i.root.getSrc("link",r.a?r.a.href:"").then((function(t){if(r.a)i.root._editVal(i.opts[6]+"."+o+".a.href",r.a.href,t,!0);else{var s={name:"a",attrs:{href:t},children:[r]};r.a=s.attrs,i.root._editVal(i.opts[6]+"."+o,r,s,!0)}wx.showToast({title:"成功"})})).catch((function(){})):"预览图"===a[n]?i.root.getSrc("img",r.attrs["original-src"]||"").then((function(s){i.root._editVal(i.opts[6]+"."+o+".attrs.original-src",r.attrs["original-src"],s instanceof Array?s[0]:s,!0),t.showToast({title:"成功"})})).catch((function(){})):"删除"===a[n]?i.remove(o):(i.root._setData(i.opts[6]+"."+o+".attrs.ignore",!r.attrs.ignore),t.showToast({title:"成功"}))}}),this.root._lock=!0,setTimeout((function(){i.root._lock=!1}),50)}else{var n=this.childs[s.currentTarget.dataset.i];if(n.a)return void this.linkTap(n.a);if(n.attrs.ignore)return;this.root.$emit("imgtap",n.attrs),this.root.previewImg&&t.previewImage({showmenu:this.root.showImgMenu,current:parseInt(n.attrs.i),urls:this.root.imgList})}},imgLongTap:function(t){},imgLoad:function(s){var i=this;this.opts[4]&&this.$nextTick((function(){var s=i.childs[e].attrs.id||"n"+e;t.createSelectorQuery().in(i).select("#"+s).boundingClientRect().exec((function(t){i.$set(i.ctrl,"h"+e,t[0].height)}))}));var e=s.currentTarget.dataset.i;if(this.childs[e].w)(this.opts[1]&&!this.ctrl[e]||-1===this.ctrl[e])&&this.$set(this.ctrl,e,1);else if(this.$set(this.ctrl,e,s.detail.width),this.opts[4]){var o=this.opts[6]+"."+e+".attrs.";s.detail.width<150&&this.root._setData(o+"ignore","T"),this.root._setData(o+"width",s.detail.width.toString())}},linkTap:function(s){var i=this;if(this.opts[4]){var o=s.currentTarget.dataset.i,r=this.childs[o],a=this.root._getItem(r);this.root._tooltip({top:e(s),items:a,success:function(s){"更换链接"===a[s]?i.root.getSrc("link",r.attrs.href).then((function(s){i.root._editVal(i.opts[6]+"."+o+".attrs.href",r.attrs.href,s,!0),t.showToast({title:"成功"})})).catch((function(){})):i.remove(o)}})}else{var n=s.currentTarget?this.childs[s.currentTarget.dataset.i]:{},c=n.attrs||s,h=c.href;this.root.$emit("linktap",Object.assign({innerText:this.root.getText(n.children||[])},c)),h&&("#"===h[0]?this.root.navigateTo(h.substring(1)).catch((function(){})):h.split("?")[0].includes("://")?this.root.copyLink&&t.setClipboardData({data:h,success:function(){return t.showToast({title:"链接已复制"})}}):t.navigateTo({url:h,fail:function(){t.switchTab({url:h,fail:function(){}})}}))}},mediaError:function(t){var s=t.currentTarget.dataset.i,i=this.childs[s];if("video"===i.name||"audio"===i.name){var e=(this.ctrl[s]||0)+1;if(e>i.src.length&&(e=0),e<i.src.length)return void this.$set(this.ctrl,s,e)}else"img"===i.name&&this.opts[2]&&this.$set(this.ctrl,s,-1);this.root&&this.root.$emit("error",{source:i.name,attrs:i.attrs,errMsg:t.detail.errMsg})}}};s.default=r}).call(this,i("543d")["default"])},"541e":function(t,s,i){},"65af":function(t,s,i){"use strict";i.r(s);var e=i("3230"),o=i.n(e);for(var r in e)"default"!==r&&function(t){i.d(s,t,(function(){return e[t]}))}(r);s["default"]=o.a},"6d0d":function(t,s,i){"use strict";var e=function(t){t.options.wxsCallMethods||(t.options.wxsCallMethods=[])};s["a"]=e},"94c3":function(t,s,i){"use strict";i.r(s);var e=i("d412"),o=i("65af");for(var r in o)"default"!==r&&function(t){i.d(s,t,(function(){return o[t]}))}(r);i("0718");var a,n=i("f0c5"),c=i("6d0d"),h=Object(n["a"])(o["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],a);"function"===typeof c["a"]&&Object(c["a"])(h),s["default"]=h.exports},d412:function(t,s,i){"use strict";var e;i.d(s,"b",(function(){return o})),i.d(s,"c",(function(){return r})),i.d(s,"a",(function(){return e}));var o=function(){var t=this,s=t.$createElement;t._self._c},r=[]}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/mp-html/node/node-create-component',
    {
        'components/mp-html/node/node-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("94c3"))
        })
    },
    [['components/mp-html/node/node-create-component']]
]);
